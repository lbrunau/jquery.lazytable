!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=e,this.callbacks=[],this.transitions={}}return o(t,[{key:"addTransition",value:function(t,e,n){this.transitions[t]||(this.transitions[t]={}),this.transitions[t][e]=n}},{key:"_transitState",value:function(t){var e=this.state;this.state=t;var n=!0,o=!1,r=void 0;try{for(var i,a=this.callbacks[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){(0,i.value)(e,t)}}catch(t){o=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}}},{key:"trigger",value:function(t,e){var n=this;if(this.transitions[this.state]&&this.transitions[this.state][t])return new Promise(function(o,r){var i=function(){n._transitState(n.transitions[n.state][t]),o()};"function"==typeof e?e().then(i):i()});throw new Exception("Undefined state transition: {state: "+this.state+", action: "+t+"}")}},{key:"getState",value:function(){return this.state}},{key:"onStateEnter",value:function(t,e){"function"==typeof e&&this.onStateChange(function(n,o){o==t&&e()})}},{key:"onStateLeave",value:function(t,e){"function"==typeof e&&this.onStateChange(function(n,o){n==t&&e()})}},{key:"onStateChange",value:function(t){"function"==typeof t&&this.callbacks.push(t)}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TableStateMachine=e.TableAction=e.TableState=void 0;var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o};var a=e.TableState={EMPTY:1,IDLE:2,STARTING:3,UPDATING:4,RESETTING:5},u=e.TableAction={START:1,RESET:2,SCROLL:3,SCROLL_COMPLETE:4};e.TableStateMachine=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a.EMPTY));return t.addTransition(a.EMPTY,u.START,a.STARTING),t.addTransition(a.STARTING,u.SCROLL,a.UPDATING),t.addTransition(a.STARTING,u.RESET,a.RESETTING),t.addTransition(a.UPDATING,u.SCROLL_COMPLETE,a.IDLE),t.addTransition(a.UPDATING,u.SCROLL,a.UPDATING),t.addTransition(a.UPDATING,u.RESET,a.RESETTING),t.addTransition(a.IDLE,u.SCROLL,a.UPDATING),t.addTransition(a.IDLE,u.RESET,a.RESETTING),t.addTransition(a.RESETTING,u.RESET,a.RESETTING),t.addTransition(a.RESETTING,u.START,a.STARTING),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default),e}()},function(t,e,n){"use strict";function o(t,e){this.generatorFunction=t,this.rows=e,this.current=0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o,o.prototype.clone=function(){var t=new o(this.generatorFunction);return t.rows=this.rows,t.current=this.current,t},o.prototype.getCurrent=function(){return this.current},o.prototype.setCurrent=function(t){t>=0&&t<this.rows.length&&(this.current=t)},o.prototype.next=function(){return this.generatorFunction(this.rows[this.current++])},o.prototype.hasNext=function(){return this.current<this.rows.length},o.prototype.prev=function(){return this.generatorFunction(this.rows[--this.current])},o.prototype.hasPrev=function(){return this.current>0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this,n=this.find("table"),o=this.find("table tbody"),r={debug:!1,trHeight:0,data:[],generator:function(t){return"<tr><td>"+t.join("</td><td>")+"</td></tr>"},startIndex:0,keepExisting:!0,prefetch:0,animationCalcTime:3,appendFn:function(t){o.append(t.join())},prependFn:function(t){o.prepend(t.join())},deleteFn:function(t,e){o.children().slice(t,e).remove()},onInit:null,onRedraw:null},u=$.extend({},r,t),s=new i.default(u.generator,u.data);s.setCurrent(u.startIndex);var c=s.clone(),l=new a.TableStateMachine,f=!1,h=!1,d=function(){return new Promise(function(t,e){var n=1;!function r(){var i=o.children();i.length>0?window.setTimeout(function(){t(i.get(0))},16):n++<10?window.setTimeout(r,100):e()}()})},p=function(t,e,n){return new Promise(function(o,r){window.requestAnimationFrame(function r(i){var s=g(),c=[];for(;l.getState()!=a.TableState.RESETTING&&e(s)&&window.performance.now()-i<u.animationCalcTime;)c.push(t());c.length>0&&n(c);e(s)?window.requestAnimationFrame(r):o(c)})})},g=function(){var t=e.scrollTop(),n={top:Math.max(Math.floor(t/u.trHeight)-u.prefetch,0),bottom:Math.min(Math.ceil((t+e.innerHeight())/u.trHeight)+u.prefetch,u.data.length-1)};return n.center=Math.min(Math.floor((n.bottom+n.top)/2),u.data.length-1),n},m=function(){var t={top:c.getCurrent(),bottom:s.getCurrent()};return t.center=Math.min(Math.floor((t.bottom+t.top)/2),u.data.length-1),t},T=function(){var t=g(),e=m();if(t.top>e.bottom||t.bottom<e.top)return l.trigger(a.TableAction.RESET).then(y(t.center));var o=[];return t.bottom>=e.bottom&&o.push(p(function(){return s.next()},function(t){return l.getState()!=a.TableState.RESETING&&s.hasNext()&&s.getCurrent()<=t.bottom},function(t){u.appendFn(t),n.css({"margin-bottom":(u.data.length-s.getCurrent())*u.trHeight}),u.debug&&console.log("[jQuery.Lazytable] bot +"+t.length+" rows")})),t.top<e.top&&o.push(p(function(){return c.prev()},function(t){return l.getState()!=a.TableState.RESETING&&c.hasPrev()&&c.getCurrent()>t.top},function(t){u.prependFn(t.reverse()),n.css({"margin-top":c.getCurrent()*u.trHeight}),u.debug&&console.log("[jQuery.Lazytable] top +"+t.length+" rows")})),o.length>0?l.trigger(a.TableAction.SCROLL,function(){return Promise.all(o).then(function(){u.keepExisting||function(){var t=m(),e=g();e.bottom<t.bottom&&(s.setCurrent(e.bottom),u.deleteFn(e.bottom-t.bottom),n.css({"margin-bottom":(u.data.length-e.bottom)*u.trHeight}),u.debug&&console.log("[jQuery.Lazytable] bot -"+(t.bottom-e.bottom)+" rows"));e.top>t.top&&(c.setCurrent(e.top),u.deleteFn(0,e.top-t.top),n.css({"margin-top":e.top*u.trHeight}),u.debug&&console.log("[jQuery.Lazytable] top -"+(e.top-t.top)+" rows"))}(),"function"==typeof u.onRedraw&&u.onRedraw()})}).then(function(){l.trigger(a.TableAction.SCROLL_COMPLETE)}):void 0},b=function(t){return new Promise(function(n,o){var r=Math.min(Math.max(t*u.trHeight-(e.innerHeight()-u.trHeight)/2,0),e.prop("scrollHeight"));e.scrollTop(r),window.setTimeout(n,16)})},w=function(t){var n=m();return h=t,n.top<=t&&t<n.bottom?l.trigger(a.TableAction.SCROLL,function(){return function(t){return new Promise(function(n,o){var r=t*u.trHeight,i=e.scrollTop(),a=e.innerHeight(),s=-1;r+u.trHeight>i+a?s=Math.max(0,r-(a-u.trHeight)):r<i&&(s=r),s>=0&&e.scrollTop(s),window.setTimeout(n,16)})}(t)}):l.trigger(a.TableAction.RESET).then(function(){return y(t)})};var y=function(t){return v(t,!1).then(function(){return b(t)}).then(T)},v=function(t,e){return l.trigger(a.TableAction.START,function(){return new Promise(function(o,r){var i=function(){var e=t*u.trHeight,r=u.trHeight*u.data.length,i=r-e-u.trHeight;n.css({"margin-bottom":i,"margin-top":e}),o()};u.deleteFn(0),s.setCurrent(t),c.setCurrent(t),s.hasNext()?(u.appendFn([s.next()]),e?d().then(function(t){var e=window.getComputedStyle(t),n=e.getPropertyValue("height"),o=n.match(/([\.\d]+)px/);u.trHeight=o?parseFloat(o[1]):t.offsetHeight}).then(i):i()):i()})})};return u.debug&&(l.onStateChange(function(t,e){console.log("[jQuery.Lazytable] State change: "+t+" -> "+e)}),l.onStateEnter(a.TableState.IDLE,function(){var t=s.getCurrent()-c.getCurrent(),e=n.css("margin-top"),o=parseInt(e.substr(0,e.length-2)),r=n.css("margin-bottom"),i=parseInt(r.substr(0,r.length-2));console.log("[jQuery.Lazytable] nVisible: "+t),console.assert(o+i==(u.data.length-t)*u.trHeight,{message:"margin claculation wrong",nTotal:u.data.length,nVisible:t,top:o,bottom:i,trHeight:u.trHeight})})),n.addClass("empty"),l.onStateLeave(a.TableState.EMPTY,function(){n.removeClass("empty"),n.addClass("loading")}),l.onStateEnter(a.TableState.IDLE,function(){n.removeClass("loading")}),l.onStateLeave(a.TableState.IDLE,function(){n.addClass("loading")}),e.off("scroll"),e.off("lazytable:focus"),e.off("lazytable:resize"),e.css({"overflow-y":"hidden"}),v(u.startIndex,!0).then(function(){return b(u.startIndex)}).then(T).then(function(){e.css({"overflow-y":"scroll"}),"function"==typeof u.onInit&&u.onInit(),e.on("scroll",function(){T()}),e.on("lazytable:focus",function(t,e,n){w(e).then(function(){"function"==typeof n&&n()})}),e.on("lazytable:resize",function(){f||(f=!0,d().then(function(t){var e,n=window.getComputedStyle(t).getPropertyValue("height"),o=(e=n.match(/([\.\d]+)px/))?parseFloat(e[1]):t.offsetHeight;if(o>0&&o!=u.trHeight){u.trHeight=o;var r=h||Math.min(Math.floor((c.getCurrent()+s.getCurrent())/2),u.data.length-1);return y(r)}if(h)return w(h)}).then(T).finally(function(){f=!1}))})}),this};var o,r=n(2),i=(o=r)&&o.__esModule?o:{default:o},a=n(1)},function(t,e,n){"use strict";
// @license http://opensource.org/licenses/MIT
// @license http://opensource.org/licenses/MIT
!function(t){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}}()},function(t,e,n){"use strict";!function(t){for(var e=0,n=["ms","moz","webkit","o"],o=0;o<n.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[n[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[o]+"CancelAnimationFrame"]||window[n[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var o=(new Date).getTime(),r=Math.max(0,16-(o-e)),i=window.setTimeout(function(){t(o+r)},r);return e=o+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}()},function(t,e,n){"use strict";n(5),n(4);var o,r=n(3),i=(o=r)&&o.__esModule?o:{default:o};jQuery.fn.LazyTable=i.default}]);